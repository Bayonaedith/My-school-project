<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>St Paul Learning Centre | Admission Form</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: #f4f6f9;
    margin: 0;
    padding: 0;
  }

  .container {
    max-width: 600px;
    margin: 50px auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }

  h2 {
    text-align: center;
    color: #002147;
  }

  form {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  input, textarea, select, button {
    padding: 12px;
    font-size: 16px;
    border-radius: 5px;
    border: 1px solid #ccc;
    width: 100%;
    box-sizing: border-box;
  }

  button {
    background: #ffcc00;
    color: #002147;
    font-weight: 600;
    cursor: pointer;
    border: none;
  }

  button:hover {
    background: #e6b800;
  }
</style>
</head>
<body>

<div class="container">
  <h2>Student Admission Form</h2>
  <form id="admissionForm">
    <input type="text" name="studentName" placeholder="Student Name" required>
    <input type="date" name="dob" placeholder="Date of Birth" required>
    <select name="class" required>
      <option value="">Select Class</option>
      <option value="Primary 1">Primary 1</option>
      <option value="Primary 2">Primary 2</option>
      <option value="Primary 3">Primary 3</option>
      <option value="Primary 4">Primary 4</option>
      <option value="Primary 5">Primary 5</option>
      <option value="Primary 6">Primary 6</option>
    </select>
    <input type="text" name="parentName" placeholder="Parent/Guardian Name" required>
    <input type="email" name="parentEmail" placeholder="Parent/Guardian Email" required>
    <input type="tel" name="parentPhone" placeholder="Phone Number" required>
    <textarea name="additionalInfo" placeholder="Message / Additional Info" rows="4"></textarea>
    <button type="submit">Submit Application</button>
  </form>
</div>

<!-- EmailJS SDK -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<!-- Firebase SDKs -->
<script type="module">
  // Firebase imports
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCIu9Gi-TGqdjCsCxsyxyq1qV23pxVHOaI",
    authDomain: "my-school-project-6e00c.firebaseapp.com",
    projectId: "my-school-project-6e00c",
    storageBucket: "my-school-project-6e00c.appspot.com",
    messagingSenderId: "14283853516",
    appId: "1:14283853516:web:c7999ae32d83166cb8bc69",
    measurementId: "G-LTJZ2RDG15"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Initialize EmailJS
  (function(){
    emailjs.init('S17h9x6ExMG6mKaQh'); // Your Public Key
  })();

  const form = document.getElementById('admissionForm');
  form.addEventListener('submit', async function(event) {
    event.preventDefault();

    // 1️⃣ Prepare form data
    const data = {
      studentName: this.studentName.value,
      dob: this.dob.value,
      class: this.class.value,
      parentName: this.parentName.value,
      parentEmail: this.parentEmail.value,
      parentPhone: this.parentPhone.value,
      additionalInfo: this.additionalInfo.value,
      submittedAt: serverTimestamp()
    };

    try {
      // 2️⃣ Save to Firestore
      await addDoc(collection(db, "admissions"), data);

      // 3️⃣ Send Email
      await emailjs.sendForm('service_ndh30l8', 'template_0k9iqza', this);

      alert('Application submitted successfully!');
      form.reset();
    } catch (err) {
      console.error('Error submitting application:', err);
      alert('Something went wrong. Please try again.');
    }
  });
</script>

</body>
</html>
